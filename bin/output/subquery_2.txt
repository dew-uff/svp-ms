<GROUPBY>$returnflag/$linestatus</GROUPBY>
<ORDERBY>$returnflag/$linestatus</ORDERBY>
<ORDERBYTYPE></ORDERBYTYPE>
<ELMTCONSTRUCT>{l_linestatus=$linestatus, l_returnflag=$returnflag}</ELMTCONSTRUCT>
<AGRFUNC>{avg($quantity)=avg($quantity):/avg_qty, sum($quantity)=sum($quantity):/sum_qty, avg($discount)=avg($discount):/avg_disc, avg($extendedprice)=avg($extendedprice):/avg_price, sum($discountprice)=sum($discountprice):/sum_disc_price, sum($extendedprice)=sum($extendedprice):/sum_base_price, count($lineitem)=count($lineitem):/count_order, sum($charge)=sum($charge):/sum_charge}</AGRFUNC>#
<results> { for $lineitem in doc('tpch/orders.xml')/Orders/Order[position() >= 500001 and position() < 750001]/LineItem let $returnflag := $lineitem/ReturnFlag let $linestatus := $lineitem/LineStatus let $extendedprice := $lineitem/ExtendedPrice let $discountprice := $lineitem/DiscountPrice let $discount := $lineitem/Discount let $charge := $lineitem/Charge let $quantity := $lineitem/Quantity where $lineitem/ShipDate <= "1998-08-31" group by $returnflag, $linestatus return <record>    <l_returnflag>{$returnflag}</l_returnflag>    <l_linestatus>{$linestatus}</l_linestatus>    <sum_qty>{sum($quantity)}</sum_qty>    <sum_base_price>{sum($extendedprice)}</sum_base_price>    <sum_disc_price>{sum($discountprice)}</sum_disc_price>    <sum_charge>{sum($charge)}</sum_charge>    <count_qty>{count($quantity)}</count_qty><sum_price>{sum($extendedprice)}</sum_price><count_price>{count($extendedprice)}</count_price><sum_disc>{sum($discount)}</sum_disc><count_disc>{count($discount)}</count_disc><count_order>{count($lineitem)}</count_order> </record>} </results>